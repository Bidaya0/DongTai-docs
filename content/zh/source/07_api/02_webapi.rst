WebApi
==========
DongTai-WebAPI 用于处理DongTai用户资源管理的相关请求，包括：

- 项目管理请求
- 漏洞管理
- 用户数据检索
- 系统配置资源
- 用户/角色管理
- Agent部署管理
- 租户管理
- 部署文档检索

鉴权方式: 

- 通过登录流程获取csrf\_token和sessionid， 
- 通过用户对应的Token来访问对应的API。

使用Token方式，用户可在安装Agent界面找到如 

.. code-block:: bash
    
    Authorization: Token <custom-token>

此处为用户对应的token，token方式同样需要在请求头上带上一个这样的 token。

探针
----

使用流程
~~~~~~~~

#. 使用探针列表接口或探针列表接口获取 agent 的 id,token。
   （探针列表接口会包含全部的 agent 数据，而探针简易列表接口只包含探针的id和探针名）
#. 使用探针启动接口与探针停止接口控制探针的状态
#. 使用探针删除接口删除不需要的探针数据（会清除相关联的漏洞数据和检测历史）

额外
~~~~

-  可以使用探针别名修改接口修改探针名

删除探针
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/agent/{id}/delete

**请求方法** GET

**详细说明**\ ：

通过条件删除指定的项目版本

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| id       |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**

/api/v1/agent/2113/delete

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "agent及相关数据删除成功"
    }

**返回结果** Json Object

+----------+--------------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                                                                       | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+============================================================================================+========+============+============+========+========+
| status   | 状态码 :201 ; 202 ;                                                                        | 否     | [int]      |            |        |        |
+----------+--------------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :删除过程出错，请稍后重试 ; agent及相关数据删除成功 ; agent不存在或无权限访问 ;   | 否     | [string]   |            |        |        |
+----------+--------------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+

探针别名修改
~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/agent/alias/modified

**请求方法** POST

**详细说明**\ ：

修改探针别名

**请求参数** Json Object

+----------+----------------+--------+------------+------------+--------+--------+
| 参数名   | 说明           | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+================+========+============+============+========+========+
| id       | 探针的对应id   | 是     | [int]      |            |        |
+----------+----------------+--------+------------+------------+--------+--------+
| alias    | 探针的别名     | 是     | [string]   |            |        |
+----------+----------------+--------+------------+------------+--------+--------+

**请求内容**

/api/v1/agent/alias/modified

.. code:: json

    {
        "id": 226,
        "alias": "Mac OS X-owefsad.local-v1.0.0-c6f8a6358d0c47c7a7ee51c3dd88a489123"
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "修改成功"
    }

**返回结果** Json Object

+----------+-----------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                                                        | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=============================================================================+========+============+============+========+========+
| status   | 状态码 :201 ; 202 ;                                                         | 否     | [int]      |            |        |        |
+----------+-----------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :删除过程出错，请稍后重试 ; agent不存在或无权限访问 ; 修改成功 ;   | 否     | [string]   |            |        |        |
+----------+-----------------------------------------------------------------------------+--------+------------+------------+--------+--------+

探针列表
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/agents

**请求方法** GET

**详细说明**\ ： 基于所给条件获取探针信息列表

**Query参数**\ ：

+-----------------+--------+--------+------------+--------+--------+
| 参数名          | 说明   | 必填   | 类型       | 限制   | 示例   |
+=================+========+========+============+========+========+
| page            |        | 否     | [int]      |        |        |
+-----------------+--------+--------+------------+--------+--------+
| pageSize        |        | 否     | [int]      |        |        |
+-----------------+--------+--------+------------+--------+--------+
| project\_name   |        | 否     | [string]   |        |        |
+-----------------+--------+--------+------------+--------+--------+
| state           |        | 否     | [int]      |        |        |
+-----------------+--------+--------+------------+--------+--------+
| token           |        | 否     | [string]   |        |        |
+-----------------+--------+--------+------------+--------+--------+

**请求内容**

/api/v1/agents?page=1&pageSize=10&state=1&token=a

**响应内容**\ ：

.. code:: json

    {
      "status": 201,
      "msg": "success",
      "data": [
        {
          "id": 2087,
          "token": "Darwin 18.7.0-bogon-v1.0.6-bd6a6c04c8cc440a9a997ed7c928dfc4",
          "server": "探针暂未检测到流量",
          "running_status": "运行中",
          "system_load": "{\"rate\": 15.9}",
          "owner": "admin",
          "latest_time": 1635488528,
          "project_name": "Songtest1203",
          "is_core_running": 0,
          "language": "PYTHON",
          "flow": 1,
          "is_control": 1,
          "report_queue": 0,
          "method_queue": 0,
          "replay_queue": 0,
          "alias": "Darwin 18.7.0-bogon-v1.0.6-bd6a6c04c8cc440a9a997ed7c928dfc4",
          "register_time": 1635387261,
          "startup_time": 0
        },
        {
          "id": 2083,
          "token": "Windows 10-cain-v1.0.6-dongtai-agent-python",
          "server": "探针暂未检测到流量",
          "running_status": "运行中",
          "system_load": "{\"rate\": 5.4}",
          "owner": "admin",
          "latest_time": 1635483334,
          "project_name": "lost004",
          "is_core_running": 1,
          "language": "PYTHON",
          "flow": 0,
          "is_control": 1,
          "report_queue": 0,
          "method_queue": 0,
          "replay_queue": 0,
          "alias": "Windows 10-cain-v1.0.6-dongtai-agent-python",
          "register_time": 1635489059,
          "startup_time": 189
        }
      ],
      "page": {
        "alltotal": 3,
        "num_pages": 1,
        "page_size": 10
      }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+---------------------+--------+--------+------------+------------+--------+
| 参数名              | 说明   | 必填   | 类型       | 值可能性   | 示例   |
+=====================+========+========+============+============+========+
| id                  |        | 是     | [int]      |            |        |
+---------------------+--------+--------+------------+------------+--------+
| token               |        | 否     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| server              |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| running\_status     |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| system\_load        |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| owner               |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| latest\_time        |        | 否     | [int]      |            |        |
+---------------------+--------+--------+------------+------------+--------+
| project\_name       |        | 否     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| is\_core\_running   |        | 否     | [int]      |            |        |
+---------------------+--------+--------+------------+------------+--------+
| language            |        | 否     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| flow                |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| is\_control         |        | 否     | [int]      |            |        |
+---------------------+--------+--------+------------+------------+--------+
| report\_queue       |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| method\_queue       |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| replay\_queue       |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| alias               |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| register\_time      |        | 是     | [string]   |            |        |
+---------------------+--------+--------+------------+------------+--------+
| startup\_time       |        | 否     | [int]      |            |        |
+---------------------+--------+--------+------------+------------+--------+

探针启动
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/agent/start

**请求方法** POST

**详细说明**\ ： 通过指定id来启动停止的探针

**请求参数** Json Object

+----------+------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                               | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+====================================+========+============+============+========+========+
| id       | 探针的对应id                       | 否     | [int]      |            |        |
+----------+------------------------------------+--------+------------+------------+--------+--------+
| ids      | agent对应的id，使用","进行切分。   | 否     | [string]   |            |        |
+----------+------------------------------------+--------+------------+------------+--------+--------+

**请求内容**

/api/v1/agent/start

.. code:: json

    {
        "id": 1 
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "正在启动..."
    }

**返回结果** Json Object

+----------+---------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                      | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+===========================+========+============+============+========+========+
| status   | 状态码 :201 ;             | 否     | [int]      |            |        |        |
+----------+---------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :正在暂停... ;   | 否     | [string]   |            |        |        |
+----------+---------------------------+--------+------------+------------+--------+--------+

探针停止
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/agent/stop

**请求方法** POST

**请求参数** Json Object

+----------+------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                               | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+====================================+========+============+============+========+========+
| id       | 探针的对应id                       | 是     | [int]      |            |        |
+----------+------------------------------------+--------+------------+------------+--------+--------+
| ids      | agent对应的id，使用","进行切分。   | 是     | [string]   |            |        |
+----------+------------------------------------+--------+------------+------------+--------+--------+

**请求内容**

/api/v1/agent/start

.. code:: json

    {
        "id": 1 
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "正在暂停..."
    }

**返回结果** Json Object

+----------+---------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                      | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+===========================+========+============+============+========+========+
| status   | 状态码 :201 ;             | 否     | [int]      |            |        |        |
+----------+---------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :正在暂停... ;   | 否     | [string]   |            |        |        |
+----------+---------------------------+--------+------------+------------+--------+--------+

探针详情
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/agent/{id\_}

**请求方法** GET

**详细说明**\ ：

通过条件删除指定的项目版本

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| id\_     |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**

/api/v1/agent/2113

**响应内容**\ ：

.. code:: json

    {
      "status": 201,
      "msg": "success",
      "data": {
        "agent": {
          "id": 2113,
          "token": "Mac OS X-localhost-v1.0.6-30a7571c06ec4df99e306f7fa8735e49",
          "version": "v1.0.6",
          "latest_time": 1635475404,
          "user": 208,
          "server": 1971,
          "is_running": 1,
          "is_core_running": 1,
          "control": 0,
          "is_control": 0,
          "bind_project_id": 141,
          "project_name": "SecExample",
          "online": 0,
          "project_version_id": 177,
          "language": "JAVA",
          "alias": "",
          "startup_time": 2938,
          "register_time": 1635478601
        }
      }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [object]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+----------+--------+--------+------------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+========+========+============+============+========+========+
| agent    |        | 是     | [object]   |            |        |        |
+----------+--------+--------+------------+------------+--------+--------+

+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| 参数名                 | 说明                                                    | 必填   | 类型       | 值可能性   | 示例   |
+========================+=========================================================+========+============+============+========+====+
| id                     | 探针的id                                                | 是     | [string]   |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| token                  | 探针名称                                                | 是     | [string]   |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| version                | 探针版本                                                | 是     | [string]   |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| latest\_time           | 探针的最后更新时间                                      | 是     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| is\_running            | 探针的运行状态                                          | 是     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| is\_core\_running      | 探针的运行状态                                          | 是     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| control                | 探针状态位，1代表安装，2代表卸载，0代表失去控制         | 是     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| is\_control            | 表示是否受控，0代表否，1代表是                          | 是     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| bind\_project\_id      | 绑定的项目id，如果存在则探针被绑定                      | 否     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| project\_name          | 项目名，用来初次启动探针并创建项目                      | 是     | [string]   |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| online                 | 1代表运行中，0代表离线，同一token的探针只能有一个在线   | 是     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| project\_version\_id   | 绑定项目的版本id，若果存在，则探针被绑定                | 否     | [int]      |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+
| language               | 项目中所涉及的探针对应的语言                            | 是     | [string]   |            |        |    |
+------------------------+---------------------------------------------------------+--------+------------+------------+--------+----+

组件
----

使用流程
~~~~~~~~

1. 利用项目id调用组件概况接口获取组件概况。 （项目id部分可参考项目部分）
2. 根据组件概况的大致情况，使用组件列表接口获取获取组件详情信息。

额外
~~~~

-  可使用组件详情接口，单个获取组件信息

组件概况（项目相关）
~~~~~~~~~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/sca/summary

**详细说明**\ ：

使用指定项目信息获取对应的组件概况。

**请求方法** GET

**Query参数**\ ：

+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| 参数名          | 说明                                                         | 必填   | 类型       | 限制   | 示例   |
+=================+==============================================================+========+============+========+========+
| keyword         | 模糊搜索关键词，针对package\_name字段                        | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| language        | 编程语言                                                     | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| level           | The id level of vulnerability                                | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| order           | 排序指标 : version,level,vul\_count,language,package\_name   | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| page            | 对应页码                                                     | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| pageSize        | 每页数量                                                     | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| project\_id     | 项目ID                                                       | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| project\_name   | 项目名                                                       | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| version\_id     | 默认值为项目的当前版本。                                     | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+

**请求内容**

/api/v1/sca/summary?language=JAVA&level=&project\_name=&keyword=1&order=version&project\_id=

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": {
            "language": [{
                "language": "JAVA",
                "count": 3926
            }, {
                "language": "PYTHON",
                "count": 0
            }],
            "level": [{
                "level": "高危",
                "count": 55,
                "level_id": 1
            }, {
                "level": "中危",
                "count": 13,
                "level_id": 2
            }, {
                "level": "低危",
                "count": 0,
                "level_id": 3
            }, {
                "level": "无风险",
                "count": 3858,
                "level_id": 4
            }, {
                "level": "提示",
                "count": 0,
                "level_id": 5
            }],
            "projects": [{
                "project_name": "openrasp-vulns",
                "count": 513,
                "id": 121
            }, {
                "project_name": "openrasp1.0.6",
                "count": 342,
                "id": 123
            }, {
                "project_name": "openrasp106",
                "count": 171,
                "id": 131
            }, {
                "project_name": "shop",
                "count": 152,
                "id": 85
            }, {
                "project_name": "testStars",
                "count": 87,
                "id": 116
            }]
        }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [object]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+------------+--------+--------+-----------+------------+--------+--------+
| 参数名     | 说明   | 必填   | 类型      | 值可能性   | 限制   | 示例   |
+============+========+========+===========+============+========+========+
| language   |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+
| level      |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+
| projects   |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+

+------------+--------------------------+--------+------------+------------+--------+--------+
| 参数名     | 说明                     | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+============+==========================+========+============+============+========+========+
| language   | 编程语言                 | 是     | [string]   |            |        |        |
+------------+--------------------------+--------+------------+------------+--------+--------+
| count      | 编程语言对应的漏洞数量   | 是     | [int]      |            |        |        |
+------------+--------------------------+--------+------------+------------+--------+--------+

+-------------+--------------------------+--------+------------+------------+--------+--------+
| 参数名      | 说明                     | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+=============+==========================+========+============+============+========+========+
| level       | 漏洞类型名称             | 是     | [string]   |            |        |        |
+-------------+--------------------------+--------+------------+------------+--------+--------+
| count       | 漏洞级别对应的漏洞数量   | 是     | [int]      |            |        |        |
+-------------+--------------------------+--------+------------+------------+--------+--------+
| level\_id   | 漏洞类型id               | 是     | [int]      |            |        |        |
+-------------+--------------------------+--------+------------+------------+--------+--------+

+-----------------+----------------------+--------+------------+------------+--------+--------+
| 参数名          | 说明                 | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+=================+======================+========+============+============+========+========+
| project\_name   | 项目名               | 是     | [string]   |            |        |        |
+-----------------+----------------------+--------+------------+------------+--------+--------+
| count           | 项目对应的漏洞数量   | 是     | [int]      |            |        |        |
+-----------------+----------------------+--------+------------+------------+--------+--------+
| id              | 项目ID               | 是     | [int]      |            |        |        |
+-----------------+----------------------+--------+------------+------------+--------+--------+

组件列表（项目相关）
~~~~~~~~~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/scas

**请求方法** GET

**详细说明**\ ：

使用指定项目信息获取对应的组件。

**Query参数**\ ：

+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| 参数名          | 说明                                                         | 必填   | 类型       | 限制   | 示例   |
+=================+==============================================================+========+============+========+========+
| keyword         | 模糊搜索关键词，针对package\_name字段                        | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| language        | 编程语言                                                     | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| level           | The id of level of vulnerability                             | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| order           | 排序指标 : version,level,vul\_count,language,package\_name   | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| page            | 对应页码                                                     | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| pageSize        | 每页数量                                                     | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| project\_id     | 项目ID                                                       | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| project\_name   | 项目名                                                       | 否     | [string]   |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+
| version\_id     | 默认值为项目的当前版本。                                     | 否     | [int]      |        |        |
+-----------------+--------------------------------------------------------------+--------+------------+--------+--------+

**请求内容**

/api/v1/scas?page=1&pageSize=12&language=JAVA&level=&project\_name=&keyword=1&order=version&project\_id=

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": [{
            "id": 20931,
            "package_name": "classmate-1.5.1.jar",
            "version": "1.5.1",
            "project_name": "springsec-test-prod",
            "project_id": 142,
            "project_version": "V1.0",
            "language": "JAVA",
            "agent_name": "Mac OS X-localhost-v1.0.6-30a7571c06ec4df99e306f7fa8735e49",
            "signature_value": "3fe0bed568c62df5e89f4f174c101eab25345b6c",
            "level": "无风险",
            "level_type": 4,
            "vul_count": 0,
            "dt": 1635479128
        }, {
            "id": 20932,
            "package_name": "hibernate-commons-annotations-5.1.0.Final.jar",
            "version": "5.1.0.Final",
            "project_name": "springsec-test-prod",
            "project_id": 142,
            "project_version": "V1.0",
            "language": "JAVA",
            "agent_name": "Mac OS X-localhost-v1.0.6-30a7571c06ec4df99e306f7fa8735e49",
            "signature_value": "700aeedc4a2089816621948f0379e17cbd17d5db",
            "level": "无风险",
            "level_type": 4,
            "vul_count": 0,
            "dt": 1635479128
        }, {
            "id": 20929,
            "package_name": "postgresql-42.2.14.jar",
            "version": "42.2.14",
            "project_name": "springsec-test-prod",
            "project_id": 142,
            "project_version": "V1.0",
            "language": "JAVA",
            "agent_name": "Mac OS X-localhost-v1.0.6-30a7571c06ec4df99e306f7fa8735e49",
            "signature_value": "45fa6eef266aa80024ef2ab3688d9faa38c642e5",
            "level": "无风险",
            "level_type": 4,
            "vul_count": 0,
            "dt": 1635479127
        }, {
            "id": 20930,
            "package_name": "byte-buddy-1.10.13.jar",
            "version": "1.10.13",
            "project_name": "springsec-test-prod",
            "project_id": 142,
            "project_version": "V1.0",
            "language": "JAVA",
            "agent_name": "Mac OS X-localhost-v1.0.6-30a7571c06ec4df99e306f7fa8735e49",
            "signature_value": "1426b15be5954246a9a72fd4baae1f42b9a4f45d",
            "level": "无风险",
            "level_type": 4,
            "vul_count": 0,
            "dt": 1635479127
        }],
        "page": {
            "alltotal": 3926,
            "num_pages": 328,
            "page_size": 12
        }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+--------------------+--------+--------+------------+------------+--------+----+
| 参数名             | 说明   | 必填   | 类型       | 值可能性   | 示例   |
+====================+========+========+============+============+========+====+
| id                 |        | 是     | [int]      |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| package\_name      |        | 否     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| version            |        | 否     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| project\_name      |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| project\_id        |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| project\_version   |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| language           |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| agent\_name        |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| signature\_value   |        | 否     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| level              |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| level\_type        |        | 是     | [string]   |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| vul\_count         |        | 否     | [int]      |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+
| dt                 |        | 否     | [int]      |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+

组件详情
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/sca/{id}

**请求方法** GET

**详细说明**\ ：

通过指定id来获取对应组件的详情

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| id       |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**

/api/v1/sca/20931

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": {
            "id": 20893,
            "package_name": "maven:org.springframework:spring-web:5.2.8.RELEASE:",
            "version": "5.2.8.RELEASE",
            "project_name": "springsec-test-prod",
            "project_id": 142,
            "project_version": "V1.0",
            "language": "JAVA",
            "agent_name": "Mac OS X-localhost-v1.0.6-30a7571c06ec4df99e306f7fa8735e49",
            "signature_value": "4f9542d61fff7beb6050e8028dfb6b7c6844c99a",
            "level": "中危",
            "level_type": 2,
            "vul_count": 1,
            "dt": 1635479109,
            "vuls": [{
                "safe_version": "5.2.9.RELEASE",
                "vulcve": "CVE-2020-5421",
                "vulcwe": "NVD-CWE-noinfo",
                "vulname": "Reflected File Download (RFD) Attack",
                "overview": "spring-web is vulnerable to Reflected File Download (RFD) attack. An incomplete fix of CVE-2015-5211 allows an attacker to bypass the protection against RFD attack via the `jsessionid` path parameter.\n\n",
                "teardown": "",
                "reference": "[{\"type\": \"GITHUB_FIX_COMMIT\", \"title\": \"\", \"url\": \"https://github.com/spring-projects/spring-framework/commit/dd011c991ce801660ec2be7979f3fc6462f29289\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ambari-commits] 20201019 [ambari] branch branch-2.7 updated: AMBARI-25571. Vulnerable Spring components in Ambari - CVE-2020-5398, CVE-2020-5421 (dlysnichenko) (#3246)\", \"url\": \"https://lists.apache.org/thread.html/r1c679c43fa4f7846d748a937955c7921436d1b315445978254442163@<commits.ambari.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ambari-dev] 20201019 [GitHub] [ambari] dlysnichenko merged pull request #3246: AMBARI-25571. Vulnerable Spring components in Ambari - CVE-2020-5398, CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r8b496b1743d128e6861ee0ed3c3c48cc56c505b38f84fa5baf7ae33a@<dev.ambari.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ambari-dev] 20201019 [GitHub] [ambari] dlysnichenko opened a new pull request #3246: AMBARI-25571. Vulnerable Spring components in Ambari - CVE-2020-5398, CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r9f13cccb214495e14648d2c9b8f2c6072fd5219e74502dd35ede81e1@<dev.ambari.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ambari-issues] 20201013 [jira] [Created] (AMBARI-25571) Vulnerable Spring components in Ambari - CVE-2020-5398, CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r1eccdbd7986618a7319ee7a533bd9d9bf6e8678e59dd4cca9b5b2d7a@<issues.ambari.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ambari-issues] 20201021 [jira] [Resolved] (AMBARI-25571) Vulnerable Spring components in Ambari - CVE-2020-5398, CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r5c95eff679dfc642e9e4ab5ac6d202248a59cb1e9457cfbe8b729ac5@<issues.ambari.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[hive-dev] 20201022 [jira] [Created] (HIVE-24303) Upgrade spring framework to 4.3.29.RELEASE+ due to CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/rf00d8f4101a1c1ea4de6ea1e09ddf7472cfd306745c90d6da87ae074@<dev.hive.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[hive-issues] 20201022 [jira] [Assigned] (HIVE-24303) Upgrade spring framework to 4.3.29.RELEASE+ due to CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/rc9efaf6db98bee19db1bc911d0fa442287dac5cb229d4aaa08b6a13d@<issues.hive.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[hive-issues] 20201022 [jira] [Updated] (HIVE-24303) Upgrade spring framework to 4.3.29.RELEASE+ due to CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r7e6a213eea7f04fc6d9e3bd6eb8d68c4df92a22e956e95cb2c482865@<issues.hive.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ignite-user] 20201117 Query on CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/raf7ca57033e537e4f9d7df7f192fa6968c1e49409b2348e08d807ccb@<user.ignite.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ignite-user] 20201119 Re: Query on CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/ra889d95141059c6cbe77dd80249bb488ae53b274b5f3abad09d9511d@<user.ignite.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[pulsar-commits] 20201022 [GitHub] [pulsar] Ghatage opened a new pull request #8355: [Issue 8354][pulsar-io] Upgrade spring framework version to patch CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r503e64b43a57fd68229cac4a869d1a9a2eac9e75f8719cad3a840211@<commits.pulsar.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[pulsar-commits] 20201023 [GitHub] [pulsar] Ghatage commented on pull request #8355: [Issue 8354][pulsar-io] Upgrade spring framework version to patch CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r918caad55dcc640a16753b00d8d6acb90b4e36de4b6156d0867246ec@<commits.pulsar.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[pulsar-commits] 20201026 [GitHub] [pulsar] wolfstudy commented on pull request #8355: [Issue 8354][pulsar-io] Upgrade spring framework version to patch CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/r3589ed0d18edeb79028615080d5a0e8878856436bb91774a3196d9eb@<commits.pulsar.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[pulsar-commits] 20201028 [GitHub] [pulsar] merlimat merged pull request #8355: [Issue 8354][pulsar-io] Upgrade spring framework version to patch CVE-2020-5421\", \"url\": \"https://lists.apache.org/thread.html/rb18ed999153ef0f0cb7af03efe0046c42c7242fd77fbd884a75ecfdc@<commits.pulsar.apache.org>\"}, {\"type\": \"VENDOR_DISCLOSURE\", \"title\": \"[ranger-dev] 20201007 Re: Review Request 72934: RANGER-3022: Upgrade Spring framework to version 4.3.29.RELEASE\", \"url\": \"https://lists.apache.org/thread.html/re014a49d77f038ba70e5e9934d400af6653e8c9ac110d32b1254127e@<dev.ranger.apache.org>\"}, {\"type\": \"OTHER\", \"title\": \"Vulnerability Disclosure\", \"url\": \"https://tanzu.vmware.com/security/cve-2020-5421\"}]",
                "level": "中危"
            }]
        }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [object]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+--------------------+--------+--------+------------+------------+--------+----+
| 参数名             | 说明   | 必填   | 类型       | 值可能性   | 示例   |
+====================+========+========+============+============+========+====+
| id                 |        | 是     | [int]      |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| package\_name      |        | 否     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| version            |        | 否     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| project\_name      |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| project\_id        |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| project\_version   |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| language           |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| agent\_name        |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| signature\_value   |        | 否     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| level              |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| level\_type        |        | 是     | [string]   |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| vul\_count         |        | 否     | [int]      |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| dt                 |        | 否     | [int]      |            |        |
+--------------------+--------+--------+------------+------------+--------+----+
| vuls               |        | 是     | [array]    |            |        |    |
+--------------------+--------+--------+------------+------------+--------+----+

+-----------------+--------+--------+------------+------------+--------+----+
| 参数名          | 说明   | 必填   | 类型       | 值可能性   | 示例   |
+=================+========+========+============+============+========+====+
| safe\_version   |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| vulcve          |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| vulcwe          |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| vulname         |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| overview        |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| teardown        |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| reference       |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+
| level           |        | 是     | [string]   |            |        |    |
+-----------------+--------+--------+------------+------------+--------+----+

漏洞
----

使用流程
~~~~~~~~

1. 根据漏洞状态列表接口获取获取漏洞状态字段。
2. 通过漏洞列表接口获取项目或agent对应的漏洞列表
3. 通过漏洞id使用漏洞验证接口进行重放验证
4. 自行验证完或已知的漏洞使用漏洞状态修改

漏洞概览
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/vuln/summary

**请求方法** GET

**详细说明**\ ：

使用下列条件来查看项目的漏洞数量统计

**Query参数**\ ：

+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| 参数名          | 说明                                                | 必填   | 类型       | 限制   | 示例   |
+=================+=====================================================+========+============+========+========+
| language        | 编程语言                                            | 否     | [string]   |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| level           | 漏洞等级 : 1,2,3,4                                  | 否     | [int]      |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| order           | 排序指标 : type,type,first\_time,latest\_time,url   | 否     | [string]   |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| project\_id     | 项目ID                                              | 否     | [int]      |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| project\_name   | 项目名                                              | 否     | [string]   |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| status          | 状态名                                              | 否     | [string]   |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| status\_id      | 状态ID                                              | 否     | [int]      |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| type            | 漏洞类型                                            | 否     | [string]   |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| url             | 漏洞的对应url                                       | 否     | [string]   |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+
| version\_id     | 默认值为项目的当前版本。                            | 否     | [int]      |        |        |
+-----------------+-----------------------------------------------------+--------+------------+--------+--------+

**请求内容**

/api/v1/vuln/summary?language=JAVA&level=&type=&project\_name=&url=a&order=level&status\_id=1&project\_id=58

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": {
            "language": [{
                "language": "JAVA",
                "count": 428
            }, {
                "language": "PYTHON",
                "count": 64
            }],
            "level": [{
                "level": "高危",
                "count": 254,
                "level_id": 1
            }, {
                "level": "中危",
                "count": 172,
                "level_id": 2
            }, {
                "level": "低危",
                "count": 54,
                "level_id": 3
            }, {
                "level": "无风险",
                "count": 4,
                "level_id": 4
            }, {
                "level": "提示",
                "count": 8,
                "level_id": 5
            }],
            "type": [{
                "type": "路径穿越",
                "count": 120
            }, {
                "type": "反射型XSS",
                "count": 107
            }, {
                "type": "XML外部实体注入",
                "count": 65
            }, {
                "type": "命令执行 ",
                "count": 49
            }, {
                "type": "Sql注入",
                "count": 37
            }, {
                "type": "服务器端请求伪造",
                "count": 29
            }, {
                "type": "不安全的随机数",
                "count": 27
            }, {
                "type": "不安全的hash算法",
                "count": 22
            }, {
                "type": "动态库加载",
                "count": 16
            }, {
                "type": "不安全的重定向",
                "count": 4
            }, {
                "type": "exec-code",
                "count": 3
            }, {
                "type": "没有Content-Security-Policy的响应",
                "count": 2
            }, {
                "type": "禁用 X-XSS-Protection 的响应",
                "count": 2
            }, {
                "type": "没有反点击劫持控制的页面",
                "count": 2
            }, {
                "type": "没有 X-Content-Type-Options 标头的响应",
                "count": 2
            }, {
                "type": "不安全的转发",
                "count": 1
            }, {
                "type": "",
                "count": 1
            }, {
                "type": "",
                "count": 1
            }, {
                "type": "",
                "count": 1
            }, {
                "type": "",
                "count": 1
            }],
            "projects": [{
                "project_name": "openrasp-vulns",
                "count": 178,
                "id": 121
            }, {
                "project_name": "openrasp106",
                "count": 111,
                "id": 131
            }, {
                "project_name": "openrasp1.0.6",
                "count": 63,
                "id": 123
            }, {
                "project_name": "Python-DockerVulspace",
                "count": 36,
                "id": 139
            }, {
                "project_name": "springsec",
                "count": 23,
                "id": 58
            }]
        },
        "level_data": []
    }

**返回结果** Json Object

+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| 参数名                          | 说明                     | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+=================================+==========================+========+============+============+========+========+
| data                            |                          | 是     | [object]   |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>language                  |                          | 是     | [array]    |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>language>>language        | 编程语言                 | 是     | [string]   |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>language>>count           | 编程语言对应的漏洞数量   | 是     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>level                     |                          | 是     | [array]    |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>level>>level              | 漏洞类型名称             | 是     | [string]   |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>level>>count              | 漏洞级别对应的漏洞数量   | 是     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>level>>level\_id          | 漏洞类型id               | 是     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>type                      |                          | 是     | [array]    |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>type>>type                | 漏洞类型的对应名称       | 是     | [string]   |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>type>>count               | 漏洞类型对应的漏洞数量   | 是     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>projects                  |                          | 是     | [array]    |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>projects>>project\_name   | 项目名                   | 是     | [string]   |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>projects>>count           | 项目对应的漏洞数量       | 是     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| data>>projects>>id              | 项目ID                   | 是     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| status                          | 状态码 :201 ;            | 否     | [int]      |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+
| msg                             | 状态信息 :success ;      | 否     | [string]   |            |        |        |
+---------------------------------+--------------------------+--------+------------+------------+--------+--------+

+------------+--------+--------+-----------+------------+--------+--------+
| 参数名     | 说明   | 必填   | 类型      | 值可能性   | 限制   | 示例   |
+============+========+========+===========+============+========+========+
| language   |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+
| level      |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+
| type       |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+
| projects   |        | 是     | [array]   |            |        |        |
+------------+--------+--------+-----------+------------+--------+--------+

+------------+--------------------------+--------+------------+------------+--------+--------+
| 参数名     | 说明                     | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+============+==========================+========+============+============+========+========+
| language   | 编程语言                 | 是     | [string]   |            |        |        |
+------------+--------------------------+--------+------------+------------+--------+--------+
| count      | 编程语言对应的漏洞数量   | 是     | [int]      |            |        |        |
+------------+--------------------------+--------+------------+------------+--------+--------+

+-------------+--------------------------+--------+------------+------------+--------+--------+
| 参数名      | 说明                     | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+=============+==========================+========+============+============+========+========+
| level       | 漏洞类型名称             | 是     | [string]   |            |        |        |
+-------------+--------------------------+--------+------------+------------+--------+--------+
| count       | 漏洞级别对应的漏洞数量   | 是     | [int]      |            |        |        |
+-------------+--------------------------+--------+------------+------------+--------+--------+
| level\_id   | 漏洞类型id               | 是     | [int]      |            |        |        |
+-------------+--------------------------+--------+------------+------------+--------+--------+

+----------+--------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                     | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+==========================+========+============+============+========+========+
| type     | 漏洞类型的对应名称       | 是     | [string]   |            |        |        |
+----------+--------------------------+--------+------------+------------+--------+--------+
| count    | 漏洞类型对应的漏洞数量   | 是     | [int]      |            |        |        |
+----------+--------------------------+--------+------------+------------+--------+--------+

\| 参数名 \| 说明 \| 必填 \| 类型 \| 值可能性 \| 限制 \| 示例 \| \|
:------------ \| :------------ \| :------------ \| :------------ \|
:------------ \| :------------ \| :------------ \|
\|project\_name\|项目名\|是\|[string]\| \|\| \|
\|count\|项目对应的漏洞数量\|是\|[int]\| \|\| \|
\|id\|项目ID\|是\|[int]\| \|\| \| 



漏洞列表（项目相关）
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/vulns

**请求方法** GET

**详细说明**\ ：

获取项目对应的漏洞列表

**Query参数**\ ：

+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| 参数名          | 说明                                                 | 必填   | 类型       | 限制   | 示例   |
+=================+======================================================+========+============+========+========+
| language        | 编程语言                                             | 否     | [string]   |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| level           | 漏洞等级的id : 1,2,3,4                               | 否     | [int]      |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| order           | 排序指标 : type,level,first\_time,latest\_time,url   | 否     | [string]   |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| page            | 对应页码                                             | 否     | [int]      |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| pageSize        | 每页数量                                             | 否     | [int]      |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| project\_id     | 项目ID                                               | 否     | [int]      |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| project\_name   | 项目名                                               | 否     | [string]   |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| status          | 状态名                                               | 否     | [string]   |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| status\_id      | 状态ID                                               | 否     | [int]      |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| type            | 漏洞类型                                             | 否     | [string]   |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| url             | 漏洞的对应url                                        | 否     | [string]   |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+
| version\_id     | 默认值为项目的当前版本。                             | 否     | [int]      |        |        |
+-----------------+------------------------------------------------------+--------+------------+--------+--------+

**请求内容**

/api/v1/vulns?page=1&pageSize=20&language=JAVA&level=&type=&project\_name=&url=a&order=level&status\_id=1&project\_id=58

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": [{
            "id": 2653,
            "type": "命令执行 ",
            "hook_type_id": 40,
            "url": "http://localhost:8080/vul/cmd-003/id",
            "uri": "/vul/cmd-003/id",
            "agent_id": 484,
            "level_id": 1,
            "http_method": "GET",
            "top_stack": "org.springframework.web.method.support.HandlerMethodArgumentResolver.resolveArgument",
            "bottom_stack": "java.lang.Runtime.exec",
            "taint_position": "HEADER/PATH",
            "latest_time": 1632993094,
            "first_time": 1629774096,
            "language": "JAVA",
            "status": "待验证",
            "index": 0,
            "project_name": "springsec",
            "project_id": 58,
            "server_name": "Apache Tomcat/9.0.37",
            "server_type": "apache tomcat",
            "level_type": 1,
            "level": "高危"
        }, {
            "id": 2654,
            "type": "路径穿越",
            "hook_type_id": 44,
            "url": "http://localhost:8080/vul/file-read-001",
            "uri": "/vul/file-read-001",
            "agent_id": 484,
            "level_id": 1,
            "http_method": "GET",
            "top_stack": "org.springframework.web.method.support.HandlerMethodArgumentResolver.resolveArgument",
            "bottom_stack": "java.io.File.<init>",
            "taint_position": "GET/HEADER/PATH",
            "latest_time": 1632993094,
            "first_time": 1629774097,
            "language": "JAVA",
            "status": "待验证",
            "index": 1,
            "project_name": "springsec",
            "project_id": 58,
            "server_name": "Apache Tomcat/9.0.37",
            "server_type": "apache tomcat",
            "level_type": 1,
            "level": "高危"
        }],
        "page": {
            "alltotal": 22,
            "num_pages": 2,
            "page_size": 20
        }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

\| 参数名 \| 说明 \| 必填 \| 类型 \| 值可能性 \| 示例 \| \|
:------------ \| :------------ \| :------------ \| :------------ \|
:------------ \| :------------ \| \|id\|\|是\|[int]\|\|\|
\|type\|\|是\|[string]\|\|\| \|hook\_type\_id\|\|是\|[int]\|\|\|
\|url\|\|否\|[string]\|\|\| \|uri\|\|否\|[string]\|\|\|
\|agent\_id\|\|是\|[int]\|\|\| \|level\_id\|\|是\|[int]\|\|\|
\|http\_method\|\|否\|[string]\|\|\| \|top\_stack\|\|否\|[string]\|\|\|
\|bottom\_stack\|\|否\|[string]\|\|\|
\|taint\_position\|\|否\|[string]\|\|\|
\|latest\_time\|\|否\|[int]\|\|\| \|first\_time\|\|否\|[int]\|\|\|
\|language\|\|是\|[string]\|\|\| \|status\|\|是\|[string]\|\|\|
\|index\|\|是\|[int]\|\|\| \|project\_name\|项目名\|否\|[string]\|\|\|
\|project\_id\|项目ID\|否\|[int]\|\|\|
\|server\_name\|\|否\|[string]\|\|\|
\|server\_type\|\|是\|[string]\|\|\| \|level\_type\|\|是\|[int]\|\|\|
\|level\|\|是\|[string]\|\|\| 

### 漏洞列表（Agent相关） 
#### 接口信息

**API Path** /api/v1/plugin/vuln/list

**请求方法** GET

**详细说明**\ ：

使用agent名获取对应的漏洞列表

**Query参数**\ ：

+------------+--------------------------------------------------------------------------+--------+------------+--------+--------+
| 参数名     | 说明                                                                     | 必填   | 类型       | 限制   | 示例   |
+============+==========================================================================+========+============+========+========+
| name       | Agent名称                                                                | 否     | [string]   |        |        |
+------------+--------------------------------------------------------------------------+--------+------------+--------+--------+
| order      | 排序指标 : id,hook\_type\_id,url,http\_method,top\_stack,bottom\_stack   | 否     | [string]   |        |        |
+------------+--------------------------------------------------------------------------+--------+------------+--------+--------+
| page       | 对应页码                                                                 | 否     | [int]      |        |        |
+------------+--------------------------------------------------------------------------+--------+------------+--------+--------+
| pageSize   | 每页数量                                                                 | 否     | [int]      |        |        |
+------------+--------------------------------------------------------------------------+--------+------------+--------+--------+
| url        | 漏洞的对应url                                                            | 否     | [string]   |        |        |
+------------+--------------------------------------------------------------------------+--------+------------+--------+--------+

**请求内容**

/api/v1/plugin/vuln/list

**响应内容**\ ：

::

    {

        "data": 

    [

            {
                "id": 0,
                "type": "string",
                "level_id": 0,
                "url": "string",
                "http_method": "string",
                "top_stack": "string",
                "bottom_stack": "string",
                "hook_type_id": 0,
                "level": "string"
            }
        ],
        "status": 201,
        "msg": "success"

    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+------------------+----------------------------------+--------+------------+------------+--------+--------+
| 参数名           | 说明                             | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==================+==================================+========+============+============+========+========+
| id               |                                  | 是     | [int]      |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| type             |                                  | 是     | [string]   |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| level\_id        |                                  | 是     | [int]      |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| url              |                                  | 否     | [string]   |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| http\_method     |                                  | 否     | [string]   |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| top\_stack       |                                  | 否     | [string]   |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| bottom\_stack    |                                  | 否     | [string]   |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| hook\_type\_id   |                                  | 是     | [int]      |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+
| level            | The level name of vulnerablity   | 是     | [string]   |            |        |        |
+------------------+----------------------------------+--------+------------+------------+--------+--------+

漏洞详情
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/vuln/{id}

**请求方法** GET

**详细说明**\ ：

使用漏洞对应的id来获取漏洞详情信息

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| id       |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**

/api/v1/vuln/12811

**响应内容**\ ：

.. code:: json

{
	"status": 201,
	"msg": "success",
	"data": {
		"vul": {
			"url": "http://localhost:9999/sqli1",
			"uri": "/sqli1",
			"agent_name": "windows-DESKTOP-JLVFSOV-0.1.0-c7brhqqjdt4g5q2i0kk0",
			"http_method": "GET",
			"type": "SQL\u6ce8\u5165",
			"taint_position": "",
			"first_time": 1641527550,
			"latest_time": 1644403924,
			"project_name": "GO Project",
			"project_version": "V1.0",
			"language": "GO",
			"level": "\u9ad8\u5371",
			"level_type": 1,
			"counts": 59,
			"req_header": "GET /sqli1 HTTP/1.1\nCookie: Uid=1; Level=low; govwa=MTY0MTg3MjcwMnxEdi1CQkFFQ180SUFBUkFCRUFBQVh2LUNBQU1HYzNSeWFXNW5EQThBRFdkdmRuZGhYM05sYzNOcGIyNEVZbTl2YkFJQ0FBRUdjM1J5YVc1bkRBY0FCWFZ1WVcxbEJuTjBjbWx1Wnd3SEFBVmhaRzFwYmdaemRISnBibWNNQkFBQ2FXUUdjM1J5YVc1bkRBTUFBVEU9fCTQNkVgywBOf3ioUFL2g9CfQecKhBDeznes-kFtr_J9\nUpgrade-Insecure-Requests: 1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Mode: navigate\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8\nConnection: keep-alive\nSec-Ch-Ua: \" Not;A Brand\";v=\"99\", \"Google Chrome\";v=\"97\", \"Chromium\";v=\"97\"\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nSec-Ch-Ua-Mobile: ?0\nAccept-Encoding: gzip, deflate, br\nSec-Ch-Ua-Platform: \"Windows\"\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36\nReferer: http://localhost:9999/index\n",
			"response": "{}\n\n \n&lt;!DOCTYPE html>\n&lt;html>\n&lt;head>\n    &lt;title>Sql Injection&lt;/title>\n\n    &lt;link href=\"public/css/font-awesome-4.7.0/css/font-awesome.css\" rel=\"stylesheet\">\n\n    \n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"public/css/open-sans.css\" />\n    &lt;link href=\"public/css/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\">\n    \n    &lt;script type=\"text/javascript\" src=\"public/js/jquery-3.2.1-min.js\">&lt;/script>\n    &lt;script type=\"text/javascript\" src=\"public/js/bootstrap.min.js\">&lt;/script>\n    \n    &lt;link href=\"public/css/main.css\" rel=\"stylesheet\">\n\n    &lt;style>\n        .header {\n    background-image: url(\"public/img/header2.png\");\n    width: 1140px;\n    height: 130px;\n    margin-bottom: 20px;\n}\n    &lt;/style>\n&lt;/head>\n&lt;body>\n    &lt;div class=\"container\">\n        &lt;nav class=\"header\" role=\"navigation\">\n        &lt;/nav>\n         \n&lt;div class=\"row\">\n    &lt;div class=\"col-sm-4 col-md-3 sidebar\">\n        &lt;div class=\"nav-side-menu\">\n            &lt;div class=\"brand\">&lt;img src=\"public/img/go-icon.ico\">Vulnerabilities&lt;/div>\n            &lt;i class=\"fa fa-bars fa-2x toggle-btn\" data-toggle=\"collapse\" data-target=\"#menu-content\">&lt;/i>\n\n            &lt;div class=\"menu-list\">\n\n                &lt;ul id=\"menu-content\" class=\"menu-content collapse out\">\n                    &lt;li>\n                        &lt;a href=\"index\">\n                            &lt;i class=\"fa fa-dashboard fa-lg\">&lt;/i> Home\n                        &lt;/a>\n                    &lt;/li>\n\n                    &lt;li>\n                            &lt;a href=\"setup\">\n                                &lt;i class=\"glyphicon glyphicon-cog fa-lg\">&lt;/i> Setup/Reset\n                            &lt;/a>\n                    &lt;/li>\n                    &lt;li style=\"height:35px\">&lt;/li>\n                    &lt;li data-toggle=\"collapse\" data-target=\"#sqli\" class=\"collapsed\">\n                        &lt;a href=\"#\">&lt;i class=\"fa fa-bug fa-lg\">&lt;/i> SQL Injection &lt;span class=\"arrow\">&lt;/span>&lt;/a>\n                    &lt;/li>\n                    &lt;ul class=\"sub-menu collapse\" id=\"sqli\">\n                        &lt;li>&lt;a href=\"sqli1\">SQLI 1&lt;/a>&lt;/li>\n                        &lt;li>&lt;a href=\"sqli2?uid=1\">SQLI 2&lt;/a>&lt;/li>\n                    &lt;/ul>\n\n\n                    &lt;li data-toggle=\"collapse\" data-target=\"#xss\" class=\"collapsed\">\n                        &lt;a href=\"#\">&lt;i class=\"fa fa-bug fa-lg\">&lt;/i> Cross Site Scripting &lt;span class=\"arrow\">&lt;/span>&lt;/a>\n                    &lt;/li>\n                    &lt;ul class=\"sub-menu collapse\" id=\"xss\">\n                        &lt;li>&lt;a href=\"xss1\">XSS 1&lt;/a>&lt;/li>\n                        &lt;li>&lt;a href=\"xss2?uid=1\">XSS 2&lt;/a>&lt;/li>\n                    &lt;/ul>\n\n                    &lt;li data-toggle=\"collapse\" data-target=\"#idor\" class=\"collapsed\">\n                            &lt;a href=\"#\">&lt;i class=\"fa fa-bug fa-lg\">&lt;/i> IDOR &lt;span class=\"arrow\">&lt;/span>&lt;/a>\n                        &lt;/li>\n                        &lt;ul class=\"sub-menu collapse\" id=\"idor\">\n                            &lt;li>&lt;a href=\"idor1\">IDOR 1&lt;/a>&lt;/li>\n                            &lt;li>&lt;a href=\"idor2\">IDOR 2&lt;/a>&lt;/li>\n                        &lt;/ul>\n\n                   \n                    &lt;li>\n                            &lt;a href=\"csa\">\n                                &lt;i class=\"fa fa-bug fa-lg\">&lt;/i> Client Side Auth\n                            &lt;/a>\n                        &lt;/li>\n                    &lt;li style=\"height:35px\">\n                    &lt;/li>\n                    &lt;li>\n                            &lt;a href=\"setting\">\n                                &lt;i class=\"glyphicon glyphicon-cog fa-lg\">&lt;/i> Setting\n                            &lt;/a>\n                        &lt;/li>\n                    &lt;li>\n                            &lt;a href=\"logout\">\n                                &lt;i class=\"fa fa-sign-out fa-lg\">&lt;/i> Logout\n                            &lt;/a>\n                        &lt;/li>\n                        \n                &lt;/ul>\n            &lt;/div>\n        &lt;/div>\n    &lt;/div>\n    \n&lt;div class=\"col-md-9\">\n    &lt;div class=\"panel panel-primary\">\n        &lt;div class=\"panel-heading\">SQL Injection Vulnerability&lt;/div>\n        &lt;div class=\"panel-body\">\n            &lt;div class=\"pnl\">\n                \n                &lt;p>This should be safe&lt;/p>\n                &lt;p>Your Profile :&lt;/p>\n                    sql: converting argument $1 type: unsupported type []interface {}, a slice of interface \n&lt;pre>\nUid     : 1\nName    : \nCity    :  \nNumber  :  \n&lt;/pre>\n                &lt;div class=\"more-info\">\n                    &lt;span>More Info :&lt;/span>\n                    &lt;a target=\"_blank\" href=\"http://www.sqlinjection.net/union/\">http://www.sqlinjection.net/union/&lt;/a>\n                    &lt;a target=\"_blank\" href=\"https://www.owasp.org/index.php/SQL_Injection\">https://www.owasp.org/index.php/SQL_Injection&lt;/a>\n                &lt;/div>\n            &lt;/div>\n        &lt;/div>\n    &lt;/div>\n&lt;/div>\n\n&lt;/div>\n\n\n    &lt;footer class=\"footer\">\n        &lt;div class=\"container\">\n          &lt;span>&lt;i class=\"fa fa-copyright\">&lt;/i>Nemosecurity&lt;/span>\n        &lt;/div>\n      &lt;/footer>\n&lt;/div>\n\n&lt;/body>\n\n&lt;/html>\n ",
			"graph": [{
				"type": "\u6c61\u70b9\u6765\u6e90\u65b9\u6cd5",
				"file": "github.com/govwa/util",
				"caller": "github.com/govwa/util.GetCookie(0xc000426e00, {0xa8b309, 0x3})\n()",
				"line_number": 48,
				"class": "(*Request)",
				"method": "Cookie",
				"source": "11055881",
				"source_value": "Uid ",
				"target": "824634230464, 824634230468, 0, 0, 0, 0",
				"target_value": "Uid 1     ",
				"node": "(*Request).Cookie()",
				"tag": "source",
				"code": "<em>Uid 1     </em> = github.com/HXSecurity/DongTai-agent-go/core/http/httpRequestCookie.Cookie(0xc000426e00, {0xa8b309, 0x3})\n(...)"
			}, {
				"type": "\u4f20\u64ad\u65b9\u6cd5",
				"file": "github.com/govwa/vulnerability/sqli.(*Profile)",
				"caller": "github.com/govwa/vulnerability/sqli.(*Profile).UnsafeQueryGetData(0xc000527bc0, {0xc00007c6c4, 0x1})\n()",
				"line_number": 36,
				"class": "fmt",
				"method": "Sprintf",
				"source": "11220318, 824634230468",
				"source_value": "SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=%s 1 ",
				"target": "824634687920",
				"target_value": "SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=1 ",
				"node": "fmt.Sprintf()",
				"tag": "propagator",
				"code": "<em>SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=1 </em> = github.com/HXSecurity/DongTai-agent-go/core/base/fmtSprintf.Sprintf({0xab355e, 0x90}, {0xc0002b50f0, 0x1, 0x1})\n(..., <em>SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=%s 1 </em>, ...)"
			}, {
				"type": "\u5371\u9669\u65b9\u6cd5",
				"file": "github.com/govwa/vulnerability/sqli.(*Profile)",
				"caller": "github.com/govwa/vulnerability/sqli.(*Profile).UnsafeQueryGetData(0xc000527bc0, {0xc00007c6c4, 0x1})\n()",
				"line_number": 40,
				"class": "(*DB)",
				"method": "Query",
				"source": "824634687920",
				"source_value": "SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=1 ",
				"target": "",
				"target_value": "",
				"node": "(*DB).Query()",
				"tag": "sink",
				"code": "github.com/HXSecurity/DongTai-agent-go/core/base/sqlDBQuery.Query(0xc00020e680, {0xc0000ec1b0, 0x8f}, {0x0, 0x0, 0x0})\n(..., <em>SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=1 </em>, ...)"
			}],
			"context_path": "",
			"client_ip": "[::1]:62431",
			"status": "\u5f85\u9a8c\u8bc1",
			"taint_value": "SELECT p.user_id, p.full_name, p.city, p.phone_number \n\t\t\t\t\t\t\t\tFROM Profile as p,Users as u \n\t\t\t\t\t\t\t\twhere p.user_id = u.id \n\t\t\t\t\t\t\t\tand u.id=1 ",
			"param_name": {},
			"method_pool_id": 466892,
			"project_id": 367,
			"is_need_http_detail": true
		},
		"server": {
			"name": "server.name",
			"hostname": "DESKTOP-JLVFSOV",
			"ip": "192.168.2.161",
			"port": 9999,
			"container": "JavaApplication",
			"server_type": "",
			"container_path": "C:\\Users\\jjz\\AppData\\Local\\Temp\\GoLand\\",
			"runtime": "",
			"environment": "\"\":\"::=::\\\\\",\"ALLUSERSPROFILE\":\"C:\\\\ProgramData\",\"APPDATA\":\"C:\\\\Users\\\\jjz\\\\AppData\\\\Roaming\",\"CATALINA_BASE\":\"D:\\\\Program Files\\\\apache-tomcat-8.5.70\",\"CATALINA_HOME\":\"D:\\\\Program Files\\\\apache-tomcat-8.5.70\",\"CGO_CFLAGS\":\"-O0 -g\",\"CLASSPATH\":\".;D:\\\\Prog",
			"command": ""
		},
		"strategy": {
			"desc": "\u8f6f\u4ef6\u4f7f\u7528\u6765\u81ea\u4e0a\u6e38\u7ec4\u4ef6\u7684\u5916\u90e8\u5f71\u54cd\u7684\u8f93\u5165\u6765\u6784\u9020\u5168\u90e8\u6216\u90e8\u5206SQL\u547d\u4ee4\uff0c\u4f46\u4e0d\u4f1a\u4e2d\u548c\u6216\u4e0d\u6b63\u786e\u5730\u4e2d\u548c\u4e86\u7279\u6b8a\u5143\u7d20\uff0c\u8fd9\u4e9b\u7279\u6b8a\u5143\u7d20\u5728\u5c06\u5176\u53d1\u9001\u5230\u4e0b\u6e38\u7ec4\u4ef6\u65f6\u53ef\u80fd\u4f1a\u4fee\u6539\u9884\u671f\u7684SQL\u547d\u4ee4\u3002",
			"sample_code": "",
			"repair_suggestion": "\u9632\u8303SQL\u6ce8\u5165\uff0c\u6807\u51c6\u65b9\u6848\u4e3a\u8f93\u5165\u9a8c\u8bc1\u4e0e\u53c2\u6570\u5316\u67e5\u8be2\u76f8\u7ed3\u5408\u3002\n\u8f93\u5165\u9a8c\u8bc1\u5206\u4e3a\u767d\u540d\u5355\u548c\u9ed1\u540d\u5355\u4e24\u79cd\u65b9\u5f0f\uff0c\u901a\u5e38\u5728\u7cfb\u7edf\u4e2d\u662f\u7ed3\u5408\u5230\u4e00\u8d77\u6765\u5b8c\u6210\u8f93\u5165\u9a8c\u8bc1\uff0c\u5177\u4f53\u5b9e\u73b0\u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u5b8c\u6210\u3002\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u65b9\u9762\uff1a\n(1) \u5728\u53ef\u4fe1\u7cfb\u7edf\uff08\u6bd4\u5982\uff1a\u670d\u52a1\u5668\uff09\u4e0a\u6267\u884c\u6240\u6709\u7684\u6570\u636e\u9a8c\u8bc1\u3002\n(2) \u9a8c\u8bc1\u6240\u6709\u6765\u81ea\u4e0d\u53ef\u4fe1\u6570\u636e\u6e90\uff08\u6bd4\u5982\uff1a\u6570\u636e\u5e93\uff0c\u6587\u4ef6\u6d41\uff0c\u7b49\uff09\u7684\u6570\u636e\u3002\n(3) \u5e94\u5f53\u4e3a\u5e94\u7528\u7a0b\u5e8f\u5e94\u63d0\u4f9b\u4e00\u4e2a\u96c6\u4e2d\u7684\u8f93\u5165\u9a8c\u8bc1\u673a\u5236\u548c\u89c4\u5219\u3002\n(4) \u4e3a\u6240\u6709\u8f93\u5165\u660e\u786e\u6070\u5f53\u7684\u5b57\u7b26\u96c6\uff0c\u6bd4\u5982\uff1aUTF-8\u3002\u5728\u8f93\u5165\u9a8c\u8bc1\u524d\uff0c\u5c06\u6570\u636e\u6309\u7167\u5e38\u7528\u5b57\u7b26\u8fdb\u884c\u7f16\u7801\uff08\u89c4\u8303\u5316\uff09\u3002\u5982\u679c\u8fdb\u884c\u5173\u952e\u5b57\u7684\u9a8c\u8bc1\uff0c\u8bf7\u5148\u7edf\u4e00\u5927\u5c0f\u5199\u3002\n(5) \u9a8c\u8bc1\u7684\u4e0d\u4ec5\u662f\u53c2\u6570\uff0c\u5305\u542b\u6240\u6709\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u6570\u636e\uff0c\u5305\u62ec\uff1a\u6240\u6709\u53c2\u6570\u3001URL\u3001HTTP\u5934\u4fe1\u606f\uff08\u6bd4\u5982\uff1acookie\u540d\u5b57\u548c\u6570\u636e\u503c\uff09\u3002\n(6) \u9a8c\u8bc1\u6b63\u786e\u7684\u6570\u636e\u7c7b\u578b\u3001\u9a8c\u8bc1\u6570\u636e\u8303\u56f4\u3001\u9a8c\u8bc1\u6570\u636e\u957f\u5ea6\u3002\n(7) \u8bf7\u8003\u8651\u662f\u5426\u5141\u8bb8\u8f93\u5165\u5e38\u89c1\u5371\u9669\u5b57\u7b26\u3002\u90e8\u5206\u5e38\u89c1\u7684\u5371\u9669\u5b57\u7b26\u5305\u62ec\uff1a< > \"\" ' % ( ) & +  ' \"\" \u3002\n(8) \u7279\u6b8a\u5b57\u7b26\u5355\u72ec\u9a8c\u8bc1\uff1a\u7a7a\u5b57\u8282 (%00)\uff1b\u6362\u884c\u7b26 (%0d, %0a, \n, \n)\uff1b\u8def\u5f84\u66ff\u4ee3\u5b57\u7b26\u201c\u70b9-\u70b9-\u659c\u6760\u201d\uff08../\u6216 ..\uff09\u3002\u9a8c\u8bc1\u66ff\u4ee3\u5b57\u7b26\uff1a %c0%ae%c0%ae/ (\u4f7f\u7528\u89c4\u8303\u5316 \u9a8c\u8bc1\u53cc\u7f16\u7801\u6216\u5176\u4ed6\u7c7b\u578b\u7684\u7f16\u7801\u653b\u51fb)\u3002\n\u53c2\u8003\u4ee3\u7801\uff1a\n(1) \u4f7f\u7528\u7279\u6b8a\u5b57\u7b26\u8fc7\u6ee4\u7a0b\u5e8f\u9632\u62a4SQL\u6ce8\u5165\u653b\u51fb\uff1a\n\u4ee3\u7801\u529f\u80fd\uff1a\u5bf9HTTP\u8bf7\u6c42\u4e2d\u7684\u6240\u6709\u53c2\u6570\u8fdb\u884c\u5371\u9669\u5b57\u7b26\u8fc7\u6ee4\uff0c\u53d1\u73b0\u5371\u9669\u5b57\u7b26\u53ef\u8df3\u8f6c\u5230\u76f8\u5e94\u7684\u9519\u8bef\u9875\u9762\u3002\n```java\npublic void doFilter(ServletRequest args0,\nServletResponse args1,FilterChain chain)\nthrows IOException, ServletException {\nHttpServletRequest req=(HttpServletRequest)args0;\nHttpServletResponse res=(HttpServletResponse)args1;\n//\u83b7\u5f97\u6240\u6709\u8bf7\u6c42\u53c2\u6570\u540d\nEnumeration params = req.getParameterNames();\nString sql = \"\"\"\";\nwhile (params.hasMoreElements()) {\n//\u5f97\u5230\u53c2\u6570\u540d\nString name = params.nextElement().toString();\n//\u5f97\u5230\u53c2\u6570\u5bf9\u5e94\u503c\nString[] value = req.getParameterValues(name);\nfor (int i = 0; i < value.length; i++) {\nsql = sql + value[i];\n}\n}\n//\u6709sql\u6ce8\u5165\u548cXSS\u5371\u9669\u5b57\u7b26\nif (sqlValidate(sql)) {\nthrow new IOException(\"\"\u8bf7\u6c42\u6709\u975e\u6cd5\u5b57\u7b26\uff1a\"\"+sql);\n} else {\nchain.doFilter(args0,args1);\n}\n}\nprotected static boolean sqlValidate(String str) {\nstr = str.toLowerCase(); //\u7edf\u4e00\u8f6c\u4e3a\u5c0f\u5199\nString badStr = \"\"and|exec|insert|select|delete\n|update|count|union|master|truncate|char|declare\n|cast|set|fetch|varchar|sysobjects|drop\n|`|'|\"\"|<|>|(|)|/||=|+|-|#|*|;|%\"\";\nString[] badStrs = badStr.split(\"\"|\"\");\nfor (int i = 0; i < badStrs.length; i++) {\nif (str.indexOf(badStrs[i]) >= 0) {\nreturn true; //\u53c2\u6570\u4e2d\u5305\u542b\u8981\u8fc7\u6ee4\u5173\u952e\u5b57;\n}\n}\nreturn false; //\u53c2\u6570\u4e2d\u4e0d\u5305\u542b\u8981\u8fc7\u6ee4\u5173\u952e\u5b57;\n}\n```\n(2) \u901a\u8fc7\u53c2\u6570\u5316\u67e5\u8be2\u65b9\u5f0f\u8fdb\u884cSQL\u6ce8\u5165\u653b\u51fb\u9632\u62a4\uff1a\n```java\nString sql = \u201cselect * from product where cat=\u2019?\u2019 and price >\u2019?\u2019\u201d;\nPreparedStatement pstmt = con.prepareStatement(sql);\npstmt.setInt(1, request.getParameter(\u201ccat\u201d));\npstmt.setString(2, request.getParameter(\u201cprice\u201d));\nResultSet rs = pstmt.executeQuery();\n```\n(3) \u4f7f\u7528MyBatis\u6280\u672f\uff0c\u901a\u8fc7Mapper.xml\u6587\u4ef6\u5b9a\u4e49SQL\u8bed\u53e5\u8fdb\u884cSQL\u6ce8\u5165\u653b\u51fb\u9632\u62a4\uff1a\n```\n<mapper namespace=\"TestUser\"> //\u547d\u540d\u7a7a\u95f4\n<select id=\"getById\" parameterType=\"java.lang.String\"\nresultMap=\"TestFlowResult\">\nselect\n<include refid=\"TestFlowColumns\" />\n```\n\u5728\u7f16\u5199mybatis\u7684\u6620\u5c04\u8bed\u53e5\u65f6\uff0c\u5c3d\u91cf\u91c7\u7528\u201c#{xxx}\u201d\u8fd9\u6837\u7684\u683c\u5f0f\u3002\u82e5\u4e0d\u5f97\u4e0d\u4f7f\u7528\u201cNULL\u201d\u8fd9\u6837\u7684\u53c2\u6570\uff0c\u8981\u624b\u5de5\u5730\u505a\u597d\u8fc7\u6ee4\u5de5\u4f5c\uff0c\u6765\u9632\u6b62sql\u6ce8\u5165\u653b\u51fb\u3002\n(4) \u5f3a\u7c7b\u578b\u7684\u53c2\u6570\u5316\u67e5\u8be2\uff0c\u5373\u5728\u6570\u636e\u5e93\u589e\u52a0\u3001\u67e5\u8be2\u3001\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0csql\u8bed\u53e5\u4e2d\u6240\u6709\u8f93\u5165\u53c2\u6570\u7edf\u4e00\u91c7\u7528#param#\u65b9\u5f0f\u3002\u793a\u4f8b\u5982\u4e0b:\n<update id=\"\"updatePtaskDetailState\"\" parameterClass=\"\"java.lang.String\"\">\nupdate ZX_PTASKDETAIL set BATCHJNLNOSTATE = '4' where JNLNO = #jnlNo#\n}\n(5)\u9700\u8981\u4f7f\u7528like\u8bed\u53e5\u7684\u5730\u65b9\u53ef\u4ee5\u4f7f\u7528'%'||#param#||'%'\u6216concat(concat('%',#param#),'%')\u907f\u514d\u6ce8\u5165\u3002\u793a\u4f8b\u5982\u4e0b\nselect * from ZX_PCIF where name like '%'||#name#||'%'"
		}
	}
}
**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [object]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+------------+--------+--------+------------+------------+--------+--------+
| 参数名     | 说明   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+============+========+========+============+============+========+========+
| vul        |        | 是     | [object]   |            |        |        |
+------------+--------+--------+------------+------------+--------+--------+
| server     |        | 是     | [object]   |            |        |        |
+------------+--------+--------+------------+------------+--------+--------+
| strategy   |        | 是     | [object]   |            |        |        |
+------------+--------+--------+------------+------------+--------+--------+

+----------------------+--------+--------+------------+------------+--------+--------+
| 参数名               | 说明   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+======================+========+========+============+============+========+========+
| desc                 |        | 是     | [string]   |            |        |        |
+----------------------+--------+--------+------------+------------+--------+--------+
| sample\_code         |        | 是     | [string]   |            |        |        |
+----------------------+--------+--------+------------+------------+--------+--------+
| repair\_suggestion   |        | 是     | [string]   |            |        |        |
+----------------------+--------+--------+------------+------------+--------+--------+

+-------------------+--------+--------+------------+------------+--------+--------+
| 参数名            | 说明   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+===================+========+========+============+============+========+========+
| name              |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| hostname          |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| ip                |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| port              |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| container         |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| server\_type      |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| container\_path   |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| runtime           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| environment       |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| command           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+

+-------------------+--------+--------+------------+------------+--------+--------+
| 参数名            | 说明   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+===================+========+========+============+============+========+========+
| type              |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| file          |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| caller                |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| line\_number              |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| class         |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| method      |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| source   |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| source\_value           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| target       |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| target\_value           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| node           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| tag           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+
| code           |        | 是     | [string]   |            |        |        |
+-------------------+--------+--------+------------+------------+--------+--------+




\| 参数名 \| 说明 \| 必填 \| 类型 \| 值可能性 \| 限制 \| 示例 \| \|
:------------ \| :------------ \| :------------ \| :------------ \|
:------------ \| :------------ \| :------------ \| \|url\|
\|是\|[string]\| \|\| \| \|uri\| \|是\|[string]\| \|\| \|
\|agent\_name\| \|是\|[string]\| \|\| \| \|http\_method\|
\|是\|[string]\| \|\| \| \|type\| \|是\|[string]\| \|\| \|
\|taint\_position\| \|是\|[string]\| \|\| \| \|first\_time\|
\|是\|[int]\| \|\| \| \|latest\_time\| \|是\|[int]\| \|\| \|
\|project\_name\|项目名\|是\|[string]\| \|\| \|
\|project\_version\|项目的版本名。\|是\|[string]\| \|\| \|
\|language\|编程语言\|否\|[string]\| \|\| \|
\|level\|漏洞类型名称\|是\|[string]\| \|\| \|
\|level\_type\|漏洞类型id\|是\|[int]\| \|\| \| \|counts\| \|是\|[int]\|
\|\| \| \|request\_header\| \|是\|[string]\| \|\| \| \|response\|
\|是\|[string]\| \|\| \| \|graph\| \|是\|[string]\| \|\| \|
\|context\_path\| \|是\|[string]\| \|\| \| \|client\_ip\|
\|是\|[string]\| \|\| \| \|status\| \|是\|[string]\| \|\| \|
\|taint\_value\| \|是\|[string]\| \|\| \| \|param\_name\|
\|是\|[string]\| \|\| \| \|method\_pool\_id\| \|是\|[int]\| \|\| \|
\|project\_id\|项目ID\|是\|[int]\| \|\| \| 

### 漏洞验证 
#### 接口信息

**API Path** /api/v1/vul/recheck

**请求方法** GET

**详细说明**\ ：

验证用户对应的漏洞.需要指定验证行为的类型

**Query参数**\ ：

+-------------+-------------------------------------------------------------+--------+------------+--------+--------+
| 参数名      | 说明                                                        | 必填   | 类型       | 限制   | 示例   |
+=============+=============================================================+========+============+========+========+
| projectId   | 项目的对应id.只有在type参数为project时，该参数才会被使用    | 否     | [int]      |        |        |
+-------------+-------------------------------------------------------------+--------+------------+--------+--------+
| type        | 可选项有('all','project')。对应全部漏洞和指定项目的漏洞。   | 否     | [string]   |        |        |
+-------------+-------------------------------------------------------------+--------+------------+--------+--------+

**请求内容**\ ：

/api/v1/vul/recheck?type=all

**响应内容**\ ：

.. code:: json

    {
        "status":201,
        "msg":"处理成功",
        "data":{
            "no_agent":492,
            "pending":422,
            "recheck":57,
            "checking":20
        }
    }

**返回结果** Json Object

+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                                                                | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=====================================================================================+========+============+============+========+========+
| data     |                                                                                     | 是     | [object]   |            |        |        |
+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ; 202 ;                                                                 | 否     | [int]      |            |        |        |
+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :ids必须为：漏洞ID,漏洞ID 格式 ; 处理成功 ; 漏洞重放出错 ; ids不能为空 ;   | 否     | [string]   |            |        |        |
+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+

+-------------+----------------------+--------+-------------+------------+--------+
| 参数名      | 说明                 | 必填   | 类型        | 值可能性   | 示例   |
+=============+======================+========+=============+============+========+
| no\_agent   | 项目是否存在探针     | 是     | [boolean]   |            |        |
+-------------+----------------------+--------+-------------+------------+--------+
| pending     | 重放的等待队列长度   | 是     | [int]       |            |        |
+-------------+----------------------+--------+-------------+------------+--------+
| recheck     | 重放的成功队列长度   | 是     | [int]       |            |        |
+-------------+----------------------+--------+-------------+------------+--------+
| checking    | 重放的检测队列长度   | 是     | [int]       |            |        |
+-------------+----------------------+--------+-------------+------------+--------+

漏洞验证
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/vul/recheck

**请求方法** POST

**详细说明**\ ：

验证用户对应的漏洞.需要指定验证行为的类型

**REST参数**\ ：

+----------+---------------------------------+--------+---------+------------+--------+--------+
| 参数名   | 说明                            | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+=================================+========+=========+============+========+========+
| ids      | 需要验证的漏洞的id，用','分割   | 是     | [int]   |            |        |        |
+----------+---------------------------------+--------+---------+------------+--------+--------+

**请求内容**\ ：

/api/v1/vul/recheck

.. code:: json

    {
        "ids":"12986,12985,12983,12984,12982,12981,12980,12897,12978,12979,12977,12976,12975,12974,12973,12911,12972,12965,12964,12970"
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "处理成功",
        "data": {
            "no_agent": 11,
            "pending": 19,
            "recheck": 0,
            "checking": 1
        }
    }

**返回结果** Json Object

+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                                                                | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=====================================================================================+========+============+============+========+========+
| data     |                                                                                     | 是     | [object]   |            |        |        |
+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ; 202 ;                                                                 | 否     | [int]      |            |        |        |
+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :ids必须为：漏洞ID,漏洞ID 格式 ; 处理成功 ; 漏洞重放出错 ; ids不能为空 ;   | 否     | [string]   |            |        |        |
+----------+-------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+

+-------------+----------------------+--------+-------------+------------+--------+
| 参数名      | 说明                 | 必填   | 类型        | 值可能性   | 示例   |
+=============+======================+========+=============+============+========+
| no\_agent   | 项目是否存在探针     | 是     | [boolean]   |            |        |
+-------------+----------------------+--------+-------------+------------+--------+
| pending     | 重放的等待队列长度   | 是     | [int]       |            |        |
+-------------+----------------------+--------+-------------+------------+--------+
| recheck     | 重放的成功队列长度   | 是     | [int]       |            |        |
+-------------+----------------------+--------+-------------+------------+--------+
| checking    | 重放的检测队列长度   | 是     | [int]       |            |        |
+-------------+----------------------+--------+-------------+------------+--------+

漏洞状态列表
~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/vul/status\_list

**请求方法** GET

**详细说明**\ ：

漏洞状态列表，里面包含了漏洞的可选状态，调用漏洞状态修改api时请先从此API获取漏洞状态数据。

**请求内容**\ ：

/api/v1/vul/recheck

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": [{
            "id": 1,
            "name": "待验证",
            "name_en": "Pending",
            "name_zh": "待验证"
        }, {
            "id": 2,
            "name": "验证中",
            "name_en": "Verifying",
            "name_zh": "验证中"
        }, {
            "id": 3,
            "name": "已确认",
            "name_en": "Confirmed",
            "name_zh": "已确认"
        }, {
            "id": 4,
            "name": "已忽略",
            "name_en": "Ignore",
            "name_zh": "已忽略"
        }, {
            "id": 5,
            "name": "已处理",
            "name_en": "Solved",
            "name_zh": "已处理"
        }]
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

\| 参数名 \| 说明 \| 必填 \| 类型 \| 值可能性 \| 示例 \| \|
:------------ \| :------------ \| :------------ \| :------------ \|
:------------ \| :------------ \| \|id\|\|是\|[int]\|\|\|
\|name\|\|是\|[string]\|\|\| \|name\_en\|\|是\|[string]\|\|\|
\|name\_zh\|\|是\|[string]\|\|\| ### 漏洞状态修改 #### 接口信息

**API Path** /api/v1/vuln/status

**请求方法** POST

**详细说明**\ ：

修改指定id的漏洞状态，状态由以下两个参数指定，status对应状态名词，status\_id对应状态的id，均可由漏洞状态列表API获得，优先使用status\_id

**请求内容**

/api/v1/vuln/status

.. code:: json

    {
        "id": 12811,
        "status": "已忽略"
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "漏洞状态修改为已忽略"
    }

**返回结果** Json Object

\| 参数名 \| 说明 \| 必填 \| 类型 \| 值可能性 \| 限制 \| 示例 \| \|
:------------ \| :------------ \| :------------ \| :------------ \|
:------------ \| :------------ \| :------------ \| \|status\|状态码 :201
; 202 ; \|否\|[int]\| \|\| \| \|msg\|状态信息 :参数不正确 ;
漏洞状态修改为{} ; \|否\|[string]\| \|\| \| ### 漏洞总数（Agent相关）
#### 接口信息

**API Path** /api/v1/plugin/vuln/count

**请求方法** GET

**详细说明**\ ：

获取用户对应的漏洞列表

**Query参数**\ ：

+----------+--------+--------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型       | 限制   | 示例   |
+==========+========+========+============+========+========+
| name     |        | 否     | [string]   |        |        |
+----------+--------+--------+------------+--------+--------+

**请求内容**\ ：

/api/v1/plugin/vuln/count?name=string

**响应内容**\ ：

.. code:: json

    {

        "data": 0,
        "status": 201,
        "msg": "success"

    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

项目
----

一般流程
~~~~~~~~

1. 通过项目列表接口获取现有的项目。
2. 使用项目详情接口获取项目详细信息。
3. 使用项目新建/项目搜索/项目删除接口管理项目进行。
4. 通过项目版本列表接口获取项目对应的版本信息。
5. 获取当前项目的版本。

额外
~~~~

-  使用项目报告导出接口，导出项目的漏洞报告。
-  使用项目概况接口获取对应的项目漏洞信息。

当前项目版本修改
~~~~~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/version/current

**请求方法** POST

**详细说明**\ ：

基于给定条件修改特定项目的版本号

**请求参数** Json Object

+---------------+----------------+--------+------------+------------+--------+--------+
| 参数名        | 说明           | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+===============+================+========+============+============+========+========+
| version\_id   | 项目的版本id   | 是     | [string]   |            |        |
+---------------+----------------+--------+------------+------------+--------+--------+
| project\_id   | 项目ID         | 是     | [int]      |            |        |
+---------------+----------------+--------+------------+------------+--------+--------+

**请求内容**

/api/v1/project/version/current

.. code:: json

    {
        "version_id": 183,
        "project_id": 146
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "版本设置成功"
    }

**返回结果** Json Object

+----------+--------------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                                   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+========================================================+========+============+============+========+========+
| status   | 状态码 :201 ; 202 ;                                    | 否     | [int]      |            |        |        |
+----------+--------------------------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :版本设置成功 ; 版本不存在 ; 版本设置失败 ;   | 否     | [string]   |            |        |        |
+----------+--------------------------------------------------------+--------+------------+------------+--------+--------+

删除项目
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/delete

**请求方法** POST

**详细说明**\ ：

使用项目对应的id来删除项目

**请求参数** Json Object

+----------+----------+--------+---------+------------+--------+--------+
| 参数名   | 说明     | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+==========+========+=========+============+========+========+
| id       | 项目ID   | 是     | [int]   |            |        |
+----------+----------+--------+---------+------------+--------+--------+

**请求内容**\ ：

/api/v1/project/delete

.. code:: json

    {
        "id": 144
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "项目删除成功"
    }

**返回结果** Json Object

+----------+---------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================================+========+============+============+========+========+
| status   | 状态码 :201 ; 202 ;                   | 否     | [int]      |            |        |        |
+----------+---------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :删除失败 ; 项目删除成功 ;   | 否     | [string]   |            |        |        |
+----------+---------------------------------------+--------+------------+------------+--------+--------+

项目版本更新
~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/version/update

**请求方法** POST

**详细说明**\ ：

更新对应的版本信息

**请求参数** Json Object

+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| 参数名             | 说明                                   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+====================+========================================+========+============+============+========+========+
| version\_id        | 项目的版本id                           | 是     | [string]   |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| version\_name      | 项目的版本名。                         | 是     | [string]   |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| description        | 项目版本的描述                         | 是     | [string]   |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| project\_id        | 项目ID                                 | 是     | [int]      |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| current\_version   | 表示是否为当前版本，1代表是，0代表否   | 是     | [int]      |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+

**请求内容**\ ：

/api/v1/project/version/update

.. code:: json

    {
        "version_name": "1312",
        "description": "11312",
        "isEdit": true,
        "version_id": 183,
        "current_version": 1,
        "project_id": 146
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "更新成功"
    }

**返回结果** Json Object

+----------+-----------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                              | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+===================================+========+============+============+========+========+
| status   | 状态码 :201 ; 202 ;               | 否     | [int]      |            |        |        |
+----------+-----------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :更新成功 ; 参数错误 ;   | 否     | [string]   |            |        |        |
+----------+-----------------------------------+--------+------------+------------+--------+--------+

项目版本列表
~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/version/list/{project\_id}

**请求方法** GET

**详细说明**\ ：

获取项目对应的版本列表

**REST参数**\ ：

+---------------+--------+--------+---------+------------+--------+--------+
| 参数名        | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+===============+========+========+=========+============+========+========+
| project\_id   |        | 是     | [int]   |            |        |        |
+---------------+--------+--------+---------+------------+--------+--------+

**请求内容**

/api/v1/project/version/list/146

**响应内容**\ ：

.. code:: json

    {
      "status": 201,
      "msg": "查询成功",
      "data": [
        {
          "version_id": 183,
          "version_name": "1312",
          "current_version": 1,
          "description": "13123"
        },
        {
          "version_id": 182,
          "version_name": "V1.0",
          "current_version": 0,
          "description": ""
        }
      ]
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| 参数名             | 说明                                   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+====================+========================================+========+============+============+========+========+
| version\_id        | 项目的版本id                           | 是     | [int]      |            |        |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| version\_name      | 项目的版本名。                         | 是     | [string]   |            |        |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| current\_version   | 表示是否为当前版本，1代表是，0代表否   | 是     | [int]      |            |        |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| description        | 项目版本的描述                         | 是     | [string]   |            |        |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+

项目版本添加
~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/version/add

**请求方法** POST

**详细说明**\ ：

基于给定条件添加指定项目版本，若指定版本号，将基于给定条件更新指定版本信息

**请求参数** Json Object

+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| 参数名             | 说明                                   | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+====================+========================================+========+============+============+========+========+
| version\_id        | 项目的版本id                           | 是     | [string]   |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| version\_name      | 项目的版本名。                         | 是     | [string]   |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| description        | 项目版本的描述                         | 是     | [string]   |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| project\_id        | 项目ID                                 | 是     | [int]      |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+
| current\_version   | 表示是否为当前版本，1代表是，0代表否   | 是     | [int]      |            |        |
+--------------------+----------------------------------------+--------+------------+------------+--------+--------+

**请求内容**\ ：

/api/v1/project/version/add

.. code:: json

    {
        "version_name": "1312",
        "description": "13123",
        "isEdit": true,
        "project_id": 146
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "创建成功",
        "data": {
            "version_id": 183,
            "version_name": "1312",
            "description": "13123"
        }
    }

**返回结果** Json Object

+----------+-----------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                              | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+===================================+========+============+============+========+========+
| data     |                                   | 是     | [array]    |            |        |        |
+----------+-----------------------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ; 202 ;               | 否     | [int]      |            |        |        |
+----------+-----------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :参数错误 ; 创建成功 ;   | 否     | [string]   |            |        |        |
+----------+-----------------------------------+--------+------------+------------+--------+--------+

+-----------------+------------------+--------+------------+------------+--------+
| 参数名          | 说明             | 必填   | 类型       | 值可能性   | 示例   |
+=================+==================+========+============+============+========+
| version\_id     | 项目的版本id     | 是     | [string]   |            |        |
+-----------------+------------------+--------+------------+------------+--------+
| version\_name   | 项目的版本名。   | 是     | [string]   |            |        |
+-----------------+------------------+--------+------------+------------+--------+
| description     | 项目版本的描述   | 是     | [string]   |            |        |
+-----------------+------------------+--------+------------+------------+--------+

项目报告导出
~~~~~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/export

**请求方法** GET

**请求内容**\ ：

/api/v1/project/export?pid=143

**响应内容**\ ：

application/octet-stream

项目对应的word报告

**详细说明**\ ： 基于以下条件，导出指定版本的报告或是特定漏洞的报告

**Query参数**\ ：

+----------+----------------+--------+------------+--------+--------+
| 参数名   | 说明           | 必填   | 类型       | 限制   | 示例   |
+==========+================+========+============+========+========+
| pid      | 项目ID         | 是     | [int]      |        |        |
+----------+----------------+--------+------------+--------+--------+
| pname    | 项目名         | 是     | [string]   |        |        |
+----------+----------------+--------+------------+--------+--------+
| vid      | 项目的版本id   | 是     | [string]   |        |        |
+----------+----------------+--------+------------+--------+--------+

项目列表
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/projects

**请求方法** GET

**详细说明**\ ：

用户对应的项目列表，支持使用项目模糊匹配搜索

**Query参数**\ ：

+--------------+----------------------------+--------+------------+--------+--------+
| 参数名       | 说明                       | 必填   | 类型       | 限制   | 示例   |
+==============+============================+========+============+========+========+
| name         | 项目名搜索，支持模糊匹配   | 否     | [string]   |        |        |
+--------------+----------------------------+--------+------------+--------+--------+
| page         | 对应页码                   | 否     | [int]      |        |        |
+--------------+----------------------------+--------+------------+--------+--------+
| page\_size   | 每页数量                   | 否     | [int]      |        |        |
+--------------+----------------------------+--------+------------+--------+--------+

**请求内容**\ ：

/api/v1/projects?page=1&pageSize=20&name=123

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": [{
            "id": 146,
            "name": "123123321",
            "mode": "插桩模式",
            "vul_count": [],
            "agent_count": 0,
            "owner": "admin",
            "latest_time": 1635493011,
            "agent_language": []
        }, {
            "id": 143,
            "name": "songtestFlask1455",
            "mode": "插桩模式",
            "vul_count": [],
            "agent_count": 1,
            "owner": "admin",
            "latest_time": 1635490547,
            "agent_language": ["PYTHON"]
        }, {
            "id": 142,
            "name": "springsec-test-prod",
            "mode": "插桩模式",
            "vul_count": [],
            "agent_count": 1,
            "owner": "owefsad",
            "latest_time": 1635479073,
            "agent_language": ["JAVA"]
        }],
        "page": {
            "alltotal": 60,
            "num_pages": 3,
            "page_size": 20
        }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [array]    |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名            | 说明                                               | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+===================+====================================================+========+============+============+========+========+
| id                |                                                    | 是     | [int]      |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| name              |                                                    | 否     | [string]   |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| mode              |                                                    | 否     | [string]   |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| vul\_count        | Vulnerability Count                                | 是     | [string]   |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| agent\_count      | Project current surviving agent                    | 是     | [string]   |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| owner             | Project owner                                      | 是     | [string]   |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| latest\_time      |                                                    | 否     | [int]      |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+
| agent\_language   | Agent language currently included in the project   | 是     | [string]   |            |        |        |
+-------------------+----------------------------------------------------+--------+------------+------------+--------+--------+

项目搜索
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/projects/summary/{id}

**请求方法** GET

**详细说明**\ ：

项目的情况概览，包括漏洞,项目版本,探针语言等信息

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| id       |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**\ ：

/api/v1/projects/summary/146

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "success",
        "data": {
            "owner": "admin",
            "name": "123123321",
            "id": 146,
            "mode": "插桩模式",
            "latest_time": 1635493011,
            "type_summary": [],
            "day_num": [{
                    "day_label": "10-22",
                    "day_num": 0
                },
                {
                    "day_label": "10-23",
                    "day_num": 0
                },
                {
                    "day_label": "10-24",
                    "day_num": 0
                },
                {
                    "day_label": "10-25",
                    "day_num": 0
                },
                {
                    "day_label": "10-26",
                    "day_num": 0
                },
                {
                    "day_label": "10-27",
                    "day_num": 0
                },
                {
                    "day_label": "10-28",
                    "day_num": 0
                },
                {
                    "day_label": "10-29",
                    "day_num": 0
                }
            ],
            "level_count": [{
                    "level_id": 1,
                    "level_name": "高危",
                    "num": 0
                },
                {
                    "level_id": 2,
                    "level_name": "中危",
                    "num": 0
                },
                {
                    "level_id": 3,
                    "level_name": "低危",
                    "num": 0
                },
                {
                    "level_id": 4,
                    "level_name": "无风险",
                    "num": 0
                },
                {
                    "level_id": 5,
                    "level_name": "提示",
                    "num": 0
                }
            ],
            "versionData": {
                "version_id": 183,
                "version_name": "1312",
                "description": "11312"
            },
            "agent_language": []
        }
    }

**返回结果** Json Object

+----------+-----------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================+========+============+============+========+========+
| data     |                       | 是     | [object]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+----------+-----------------------+--------+------------+------------+--------+--------+

+-------------------+--------------------------------+--------+------------+------------+--------+----+
| 参数名            | 说明                           | 必填   | 类型       | 值可能性   | 示例   |
+===================+================================+========+============+============+========+====+
| name              | 项目名                         | 是     | [string]   |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| mode              | 项目模式                       | 是     | [string]   |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| id                | 项目ID                         | 是     | [int]      |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| latest\_time      | 默认值为项目的当前版本。       | 是     | [int]      |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| versionData       | 项目的版本信息                 | 是     | [string]   |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| type\_summary     | 关于漏洞类型的漏洞数量统计     | 是     | [array]    |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| agent\_language   | 项目中所涉及的探针对应的语言   | 是     | [array]    |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+
| level\_count      | 基于漏洞等级的漏洞数量统计     | 是     | [array]    |            |        |    |
+-------------------+--------------------------------+--------+------------+------------+--------+----+

+---------------+------------------+--------+------------+------------+--------+----+
| 参数名        | 说明             | 必填   | 类型       | 值可能性   | 示例   |
+===============+==================+========+============+============+========+====+
| type\_name    | 漏洞名           | 是     | [string]   |            |        |    |
+---------------+------------------+--------+------------+------------+--------+----+
| type\_count   | 漏洞类型的个数   | 是     | [int]      |            |        |    |
+---------------+------------------+--------+------------+------------+--------+----+
| type\_level   | 漏洞等级         | 是     | [int]      |            |        |    |
+---------------+------------------+--------+------------+------------+--------+----+

+---------------+--------------------------+--------+------------+------------+--------+----+
| 参数名        | 说明                     | 必填   | 类型       | 值可能性   | 示例   |
+===============+==========================+========+============+============+========+====+
| level\_name   | 漏洞等级名称             | 是     | [string]   |            |        |    |
+---------------+--------------------------+--------+------------+------------+--------+----+
| level\_id     | 漏洞等级id               | 是     | [int]      |            |        |    |
+---------------+--------------------------+--------+------------+------------+--------+----+
| num           | 漏洞级别对应的漏洞数量   | 是     | [int]      |            |        |    |
+---------------+--------------------------+--------+------------+------------+--------+----+

项目探针
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/engines/{pid}

**请求方法** GET

**详细说明**\ ：

获取项目对应的探针列表

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| pid      |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**\ ：

/api/v1/project/engines/143

**响应内容**\ ：

.. code:: json

    {
      "status": 201,
      "msg": "success",
      "data": [
        {
          "id": 2116,
          "token": "Darwin 18.7.0-bogon-v1.0.6-3752a9aad49d42fdac5bca7dd3e58bfe",
          "short_name": "Darwin 18.7.0-bogon-v1.0.6"
        }
      ]
    }

**返回结果** Json Object

+-------------------+-----------------------+--------+------------+------------+--------+--------+
| 参数名            | 说明                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+===================+=======================+========+============+============+========+========+
| data              |                       | 是     | [array]    |            |        |        |
+-------------------+-----------------------+--------+------------+------------+--------+--------+
| data>>id          | 探针id                | 是     | [int]      |            |        |        |
+-------------------+-----------------------+--------+------------+------------+--------+--------+
| data>>token       | 探针名称              | 是     | [string]   |            |        |        |
+-------------------+-----------------------+--------+------------+------------+--------+--------+
| data>>shortname   | 探针简称              | 是     | [string]   |            |        |        |
+-------------------+-----------------------+--------+------------+------------+--------+--------+
| status            | 状态码 :201 ;         | 否     | [int]      |            |        |        |
+-------------------+-----------------------+--------+------------+------------+--------+--------+
| msg               | 状态信息 :success ;   | 否     | [string]   |            |        |        |
+-------------------+-----------------------+--------+------------+------------+--------+--------+

项目详情
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/{id}

**请求方法** GET

**详细说明**\ ： 获取项目的版本信息，包括项目的当前版本

**REST参数**\ ：

+----------+--------+--------+---------+------------+--------+--------+
| 参数名   | 说明   | 必填   | 类型    | 值可能性   | 限制   | 示例   |
+==========+========+========+=========+============+========+========+
| id       |        | 是     | [int]   |            |        |        |
+----------+--------+--------+---------+------------+--------+--------+

**请求内容**

/api/v1/project/139

**响应内容**

.. code:: json

    {
      "status": 201,
      "msg": "success",
      "data": {
        "name": "lost004",
        "id": 138,
        "mode": "插桩模式",
        "scan_id": 5,
        "agents": [
          {
            "id": 2083,
            "name": "Windows 10-cain-v1.0.6-dongtai-agent-python"
          }
        ],
        "versionData": {
          "version_id": 174,
          "version_name": "V1.0",
          "description": ""
        }
      }
    }

**返回结果** Json Object

+----------+---------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                  | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+=======================================+========+============+============+========+========+
| data     |                                       | 是     | [object]   |            |        |        |
+----------+---------------------------------------+--------+------------+------------+--------+--------+
| status   | 状态码 :201 ; 203 ;                   | 否     | [int]      |            |        |        |
+----------+---------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :success ; no permission ;   | 否     | [string]   |            |        |        |
+----------+---------------------------------------+--------+------------+------------+--------+--------+

+---------------+--------------------+--------+------------+------------+--------+--------+
| 参数名        | 说明               | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+===============+====================+========+============+============+========+========+
| name          | 项目名             | 是     | [string]   |            |        |        |
+---------------+--------------------+--------+------------+------------+--------+--------+
| agents        | 项目对应的agent    | 是     | [array]    |            |        |        |
+---------------+--------------------+--------+------------+------------+--------+--------+
| mode          | 项目模式           | 是     | [string]   |            |        |        |
+---------------+--------------------+--------+------------+------------+--------+--------+
| scan\_id      | 扫描策略的对于id   | 是     | [int]      |            |        |        |
+---------------+--------------------+--------+------------+------------+--------+--------+
| versionData   | 项目的版本信息     | 是     | [object]   |            |        |        |
+---------------+--------------------+--------+------------+------------+--------+--------+
| id            | 项目ID             | 是     | [int]      |            |        |        |
+---------------+--------------------+--------+------------+------------+--------+--------+

+----------+--------------+--------+------------+------------+--------+--------+
| 参数名   | 说明         | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+==============+========+============+============+========+========+
| name     | 项目版本名   | 是     | [string]   |            |        |        |
+----------+--------------+--------+------------+------------+--------+--------+
| id       | 项目版本id   | 是     | [int]      |            |        |        |
+----------+--------------+--------+------------+------------+--------+--------+

+-----------------+----------------+--------+------------+------------+--------+--------+
| 参数名          | 说明           | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+=================+================+========+============+============+========+========+
| version\_name   | 项目版本名     | 是     | [string]   |            |        |        |
+-----------------+----------------+--------+------------+------------+--------+--------+
| version\_id     | 项目版本id     | 是     | [int]      |            |        |        |
+-----------------+----------------+--------+------------+------------+--------+--------+
| description     | 项目版本描述   | 是     | [string]   |            |        |        |
+-----------------+----------------+--------+------------+------------+--------+--------+

项目新建
~~~~~~~~

接口信息
^^^^^^^^

**API Path** /api/v1/project/add

**请求方法** POST

**详细说明**\ ：

根据所给条件新建项目; 当指定项目id时, 根据所给条件更新对应项目

**请求参数** Json Object

+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| 参数名          | 说明                               | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+=================+====================================+========+============+============+========+========+
| name            | 项目名                             | 是     | [string]   |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| agent\_ids      | agent对应的id，使用","进行切分。   | 是     | [string]   |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| mode            | 项目模式                           | 是     | [string]   |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| scan\_id        | 扫描策略的对于id                   | 是     | [int]      |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| version\_name   | 项目的版本名。                     | 是     | [string]   |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| pid             | 项目ID                             | 是     | [int]      |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+
| description     | 项目的描述信息                     | 是     | [string]   |            |        |
+-----------------+------------------------------------+--------+------------+------------+--------+--------+

**请求内容**

/api/v1/project/add

.. code:: json

    {
        "name": "123123123123",
        "mode": "插桩模式",
        "agent_ids": "1,2",
        "scan_id": 260,
        "version_name": "123132",
        "description": "1231"
    }

**响应内容**\ ：

.. code:: json

    {
        "status": 201,
        "msg": "创建成功"
    }

**返回结果** Json Object

+----------+--------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| 参数名   | 说明                                                                                 | 必填   | 类型       | 值可能性   | 限制   | 示例   |
+==========+======================================================================================+========+============+============+========+========+
| status   | 状态码 :201 ; 202 ; 203 ;                                                            | 否     | [int]      |            |        |        |
+----------+--------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+
| msg      | 状态信息 :参数错误 ; 创建失败，项目名称已存在 ; 创建成功 ; agent已被其他项目绑定 ;   | 否     | [string]   |            |        |        |
+----------+--------------------------------------------------------------------------------------+--------+------------+------------+--------+--------+

